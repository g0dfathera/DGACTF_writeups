მოცემულია pcap ფორმატის ფაილი.
გავხსნათ wireshark-ში და ვნახოთ რა პროტოკოლებია გამოყენებული.

![[Pasted image 20250521142049.png]]

პირველ რიგში შევამოწმე dns პაკეტები.

![[Pasted image 20250521142255.png]]

ყველა დომეინი ნაცნობია და დიდი ალბათობით არცერთი მათგანი არ გამოგვადგება.

პაკეტების დიდი ნაწილი არის SMB ტიპის. ყველა SMB პაკეტი არის დაკრიპტული.

ვნახოთ ntlmssp პაკეტები.

![[Pasted image 20250521142616.png]]

აქ უკვე წავაწყდით საინტერესო რამეს. შეგვიძლია ეს მონაცემები და server challenge გამოვიყენოთ, და hashcat-ით გავტეხოთ.

იმისთვის რომ SMB პაკეტების decrypt მოვახდინოთ (და მივიღოთ რაიმე ფაილი SMB-დან) საჭიროა ამოვიღოთ გამზადებული hash. რისთვისაც გამოვიყენებ ამ github-ის repo-ს - 

```
https://github.com/mlgualtieri/NTLMRawUnHide
```

![[Pasted image 20250521143803.png]]

hash გავტეხოთ hashcat-ით.

![[Pasted image 20250521144657.png]]

ახლა უკვე რადგან გვაქვს პაროლი, decrypt გავაკეთოთ wireshark-ში.

![[Pasted image 20250521145008.png]]

![[Pasted image 20250521145103.png]]

SMB პაკეტები უკვე დეკოდირებულია. შეგვიძლია ვნახოთ SMB object-ები.

![[Pasted image 20250521145205.png]]

გადმოვწეროთ rar და ვნახოთ შიგთავსი.

rar-ს პაროლი ადევს, მაგრამ მაინც შეგვიძლია string-ის საშუალებით ვნახოთ რა ინახება შიგნით.

![[Pasted image 20250521145340.png]]

ამ rar-შია მოთავსებული flag.

პაროლის bruteforce-სთვის გამოვიყენე john.

![[Pasted image 20250521145442.png]]

![[Pasted image 20250521145700.png]]

![[Pasted image 20250521145739.png]]


